<!DOCTYPE html>
<html>
<head>
    <title>Simplify Your Life</title>
    <link rel="stylesheet" href="main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-title">Simplify Your Life</div>
            <button class="toggle-btn" id="toggleSidebar">‚ò∞</button>
        </div>
        <div class="sidebar-menu">
            <a href="#excel-processor" class="menu-item active" data-page="excel-processor">
                <i class="fa-solid fa-gear"></i>
                <span class="menu-text">Excel Processor</span>
            </a>
            <a href="#email-blaster" class="menu-item" data-page="email-blaster">
                <i class="fa-solid fa-envelope"></i>
                <span class="menu-text">Email Blaster</span>
            </a>
            <a href="#wa-blaster" class="menu-item" data-page="wa-blaster">
                <i class="fa-brands fa-whatsapp"></i>
                <span class="menu-text">WA Blaster</span>
            </a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Excel Processor Page -->
        <div id="excel-processor" class="page-content active">
            <div class="container">
                <h1>Excel File Processor</h1>
                <p>Choose your processing method:</p>
                
                <!-- Regular Processing -->
                <div style="margin-bottom: 40px; padding: 20px; border: 2px solid #007cba; border-radius: 10px;">
                    <h2 style="color: #007cba; margin-bottom: 15px;">Standard Processing</h2>
                    <p style="margin-bottom: 15px; color: #666;">Use this for regular Excel file processing</p>
                    
                    <!-- Upload Area -->
                    <div class="upload-area" id="dropZone">
                        <h3>üìÅ Upload Excel File</h3>
                        <p>Click here or drag & drop your Excel file</p>
                        <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" class="hidden" />
                    </div>
                </div>

                <!-- Semula Menjadi Processing -->
                <div style="margin-bottom: 40px; padding: 20px; border: 2px solid #28a745; border-radius: 10px;">
                    <h2 style="color: #28a745; margin-bottom: 15px;">Semula Menjadi Processing</h2>
                    <p style="margin-bottom: 15px; color: #666;">Use this for enhanced processing with additional steps</p>
                    
                    <!-- Upload Area for Semula Menjadi -->
                    <div class="upload-area" id="dropZoneSemulaMenjadi">
                        <h3>üöÄ Upload for Semula Menjadi</h3>
                        <p>Click here or drag & drop your Excel file</p>
                        <input type="file" id="fileInputSemulaMenjadi" accept=".xlsx,.xls,.csv" class="hidden" />
                    </div>
                </div>

                <!-- Download Button (Initially Hidden) -->
                <button class="btn hidden" id="downloadBtn">‚¨áÔ∏è Download Processed File</button>

                <div id="status" class="status info">Please upload an Excel file to begin processing</div>

                <br><br>
                <!-- Notes Section -->
                <div style="margin-bottom: 40px; padding: 20px; border: 2px solid #6c757d; border-radius: 10px; background: #f8f9fa;">
                    <h2 style="color: #6c757d; margin-bottom: 20px; text-align: center;">üìù Color Notes</h2>
                    
                    <!-- Rule 1: Code 322 -->
                    <div style="margin-bottom: 15px; padding: 15px; border-radius: 8px; background: white; border-left: 4px solid #0c0c5e;">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;">
                            <h4 style="color: #0c0c5e; margin: 0;">Code 322 (example: 026.04.DN)</h4>
                            <button class="copy-btn" data-color="#0c0c5e" style="background: #0c0c5e; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.3s;">
                                <i class="fa-regular fa-copy"></i> Copy Color
                            </button>
                        </div>
                        <p style="margin: 5px 0; color: #666; font-size: 14px;">Dark Blue</p>
                        <p style="margin: 0; color: #888; font-size: 12px; font-family: monospace;">Hex: #0c0c5e</p>
                    </div>

                    <!-- Rule 2: 4 digit number -->
                    <div style="margin-bottom: 15px; padding: 15px; border-radius: 8px; background: white; border-left: 4px solid #0000FF;">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;">
                            <h4 style="color: #0000FF; margin: 0;">4 digit number (example: 2175)</h4>
                            <button class="copy-btn" data-color="#0000FF" style="background: #0000FF; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.3s;">
                                <i class="fa-regular fa-copy"></i> Copy Color
                            </button>
                        </div>
                        <p style="margin: 5px 0; color: #666; font-size: 14px;">Blue</p>
                        <p style="margin: 0; color: #888; font-size: 12px; font-family: monospace;">Hex: #0000FF</p>
                    </div>

                    <!-- Rule 3: Code 43 -->
                    <div style="margin-bottom: 15px; padding: 15px; border-radius: 8px; background: white; border-left: 4px solid #B10301;">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px;">
                            <h4 style="color: #B10301; margin: 0;">Code 43 (example: 2175.AEC)</h4>
                            <button class="copy-btn" data-color="#B10301" style="background: #B10301; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; transition: all 0.3s;">
                                <i class="fa-regular fa-copy"></i> Copy Color
                            </button>
                        </div>
                        <p style="margin: 5px 0; color: #666; font-size: 14px;">Red</p>
                        <p style="margin: 0; color: #888; font-size: 12px; font-family: monospace;">Hex: #B10301</p>
                    </div>

                    <!-- Rule 4: Code 433 or 3 digit number -->
                    <div style="padding: 15px; border-radius: 8px; background: white; border-left: 4px solid #495057;">
                        <h4 style="color: #495057; margin: 0 0 8px 0; font-weight: bold;">Code 433 or 3 digit number (example: 2175.AEC.001 or 051)</h4>
                        <p style="margin: 5px 0; color: #666; font-size: 14px;"><strong>Bold Text</strong></p>
                        <p style="margin: 0; color: #888; font-size: 12px;">No color - apply bold formatting only</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Email Blaster Page -->
        <div id="email-blaster" class="page-content">
            <div class="placeholder-page">
                <div class="placeholder-icon">
                    <i class="fa-solid fa-envelope"></i>
                </div>
                <div class="coming-soon">Coming Soon</div>
                <h1 class="placeholder-title">Email Blaster</h1>
                <p class="placeholder-description">
                    Send bulk emails effortlessly. Upload your contact list and message template, 
                    and we'll handle the rest. Perfect for newsletters, announcements, and marketing campaigns.
                </p>
                <button class="btn" disabled>
                    <i class="fa-solid fa-lock"></i> Under Development
                </button>
            </div>
        </div>

        <!-- WA Blaster Page -->
        <div id="wa-blaster" class="page-content">
            <div class="placeholder-page">
                <div class="placeholder-icon">
                    <i class="fa-brands fa-whatsapp"></i>
                </div>
                <div class="coming-soon">Coming Soon</div>
                <h1 class="placeholder-title">WhatsApp Blaster</h1>
                <p class="placeholder-description">
                    Send WhatsApp messages in bulk. Perfect for business announcements, 
                    event invitations, and customer notifications. Safe and efficient messaging.
                </p>
                <button class="btn" disabled>
                    <i class="fa-solid fa-lock"></i> Under Development
                </button>
            </div>
        </div>
        
        <!-- Copyright Footer -->
        <div class="copyright-footer">
            <p>
                <i class="fa-regular fa-copyright"></i>
                <span id="current-year">2024</span> All Rights Reserved.
            </p>
            <p>
                Created by <span class="copyright-name">Alfari Sidnan Ghilmana</span>
            </p>
            <p>
                <span class="copyright-id">NIP. 20000403 202505 1 004</span>
            </p>
        </div>
    </div>

    <!-- Back to Top Button -->
    <button class="back-to-top" id="backToTop" title="Back to Top">
        <i class="fa-solid fa-arrow-up"></i>
    </button>

    <!-- Include SheetJS from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script>
        // Sidebar and Navigation functionality
        class AppNavigation {
            constructor() {
                this.sidebar = document.getElementById('sidebar');
                this.mainContent = document.getElementById('mainContent');
                this.toggleBtn = document.getElementById('toggleSidebar');
                this.menuItems = document.querySelectorAll('.menu-item');
                this.pageContents = document.querySelectorAll('.page-content');
                this.isCollapsed = false;
                
                this.init();
            }
            
            init() {
                // Sidebar toggle
                this.toggleBtn.addEventListener('click', () => this.toggleSidebar());
                
                // Navigation click handlers
                this.menuItems.forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        const pageId = item.getAttribute('data-page');
                        this.navigateToPage(pageId);
                    });
                });
                
                // Load saved state from localStorage
                const savedState = localStorage.getItem('sidebarCollapsed');
                if (savedState === 'true') {
                    this.collapseSidebar();
                } else {
                    this.expandSidebar();
                }

                // Handle URL hash on page load
                this.handleInitialRoute();
            }
            
            handleInitialRoute() {
                const hash = window.location.hash.substring(1);
                if (hash && this.isValidPage(hash)) {
                    this.navigateToPage(hash);
                } else {
                    this.navigateToPage('excel-processor');
                }
            }
            
            isValidPage(pageId) {
                return document.getElementById(pageId) !== null;
            }
            
            navigateToPage(pageId) {
                // Update URL without page reload
                window.history.pushState(null, null, `#${pageId}`);
                
                // Update active menu item
                this.menuItems.forEach(item => {
                    item.classList.remove('active');
                    if (item.getAttribute('data-page') === pageId) {
                        item.classList.add('active');
                    }
                });
                
                // Show selected page content
                this.pageContents.forEach(page => {
                    page.classList.remove('active');
                    if (page.id === pageId) {
                        page.classList.add('active');
                    }
                });
                
                // Update page title
                this.updatePageTitle(pageId);
            }
            
            updatePageTitle(pageId) {
                const titles = {
                    'excel-processor': 'Excel Processor - Simplify Your Life',
                    'email-blaster': 'Email Blaster - Simplify Your Life',
                    'wa-blaster': 'WA Blaster - Simplify Your Life'
                };
                document.title = titles[pageId] || 'Simplify Your Life';
            }
            
            toggleSidebar() {
                if (this.isCollapsed) {
                    this.expandSidebar();
                } else {
                    this.collapseSidebar();
                }
            }
            
            collapseSidebar() {
                this.sidebar.classList.add('collapsed');
                this.mainContent.classList.add('expanded');
                this.isCollapsed = true;
                this.toggleBtn.innerHTML = '‚Üí';
                localStorage.setItem('sidebarCollapsed', 'true');
            }

            expandSidebar() {
                this.sidebar.classList.remove('collapsed');
                this.mainContent.classList.remove('expanded');
                this.isCollapsed = false;
                this.toggleBtn.innerHTML = '‚ò∞';
                localStorage.setItem('sidebarCollapsed', 'false');
            }
        }

        // Color Notes Manager
        class ColorNotesManager {
            constructor() {
                this.init();
            }
            
            init() {
                // Add event listeners to all copy buttons
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('copy-btn') || e.target.closest('.copy-btn')) {
                        const button = e.target.classList.contains('copy-btn') ? e.target : e.target.closest('.copy-btn');
                        this.copyHexColor(button);
                    }
                });
            }
            
            copyHexColor(button) {
                const hexColor = button.getAttribute('data-color');
                
                // Use the Clipboard API to copy the color
                navigator.clipboard.writeText(hexColor).then(() => {
                    // Show success feedback
                    const originalText = button.innerHTML;
                    const originalBackground = button.style.background;
                    
                    button.innerHTML = '<i class="fa-solid fa-check"></i> Copied!';
                    button.classList.add('copied');
                    
                    // Reset after 2 seconds
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.classList.remove('copied');
                    }, 2000);
                    
                }).catch(err => {
                    console.error('Failed to copy color: ', err);
                    // Fallback for older browsers
                    this.fallbackCopyText(hexColor, button);
                });
            }
            
            fallbackCopyText(text, button) {
                const textArea = document.createElement('textarea');
                textArea.value = text;
                textArea.style.position = 'fixed';
                textArea.style.left = '-999999px';
                textArea.style.top = '-999999px';
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                
                try {
                    document.execCommand('copy');
                    // Show success feedback
                    const originalText = button.innerHTML;
                    button.innerHTML = '<i class="fa-solid fa-check"></i> Copied!';
                    button.classList.add('copied');
                    
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.classList.remove('copied');
                    }, 2000);
                } catch (err) {
                    console.error('Fallback copy failed: ', err);
                    alert('Failed to copy color code. Please copy manually: ' + text);
                }
                
                document.body.removeChild(textArea);
            }
        }

        // Back to Top Manager
        class BackToTopManager {
            constructor() {
                this.backToTopButton = document.getElementById('backToTop');
                this.scrollThreshold = 300; // Show button after scrolling 300px
                this.init();
            }
            
            init() {
                // Add scroll event listener
                window.addEventListener('scroll', () => this.handleScroll());
                
                // Add click event listener to the button
                this.backToTopButton.addEventListener('click', () => this.scrollToTop());
                
                // Initial check
                this.handleScroll();
            }
            
            handleScroll() {
                const scrollY = window.scrollY || document.documentElement.scrollTop;
                
                if (scrollY > this.scrollThreshold) {
                    this.backToTopButton.classList.add('visible');
                } else {
                    this.backToTopButton.classList.remove('visible');
                }
            }
            
            scrollToTop() {
                // Smooth scroll to top
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
                
                // Alternative: For better browser compatibility
                // this.smoothScrollToTop();
            }
            
            // Alternative smooth scroll method for better browser support
            smoothScrollToTop() {
                const scrollToTop = () => {
                    const currentPosition = window.scrollY || document.documentElement.scrollTop;
                    
                    if (currentPosition > 0) {
                        window.scrollTo(0, currentPosition - currentPosition / 8);
                        requestAnimationFrame(scrollToTop);
                    }
                };
                
                scrollToTop();
            }
        }

        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', () => {
            window.appNavigation = new AppNavigation();
            window.colorNotesManager = new ColorNotesManager();
            window.backToTopManager = new BackToTopManager();
            
            // Set current year in copyright
            const currentYear = new Date().getFullYear();
            document.getElementById('current-year').textContent = currentYear;
        });

        // Handle browser back/forward buttons
        window.addEventListener('popstate', () => {
            const hash = window.location.hash.substring(1);
            if (hash && window.appNavigation.isValidPage(hash)) {
                window.appNavigation.navigateToPage(hash);
            }
        });
    </script>
    <script src="app.js"></script>
</body>
</html>